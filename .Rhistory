summary(gbcsCS)
summary(lnodes)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
lnodes <- glm(nodes ~ age+menopause+hormone+size+grade+prog_recp+estrg_recp,data=gbcsCS,family="poisson")
summary(lnodes)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
lnodes <- glm(nodes ~ age+menopause+hormone+size+grade+prog_recp,data=gbcsCS,family="poisson")
summary(lnodes)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
lnodes <- glm(nodes ~ age+hormone+size+grade+prog_recp,data=gbcsCS,family="poisson")
summary(lnodes)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
lnodes <- glm(nodes ~ age+size+grade+prog_recp,data=gbcsCS,family="poisson")
lnodes
summary(lnodes)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
lnodes <- glm(nodes ~ 1,data=gbcsCS,family="poisson")
lnodes
lnodes$fitted.values
lnodes$fitted[1]
lnodes <- glm(nodes ~ age+size+grade+prog_recp,data=gbcsCS,family="poisson")
lnodes$fitted[1]
lnodes$fitted
summary(lnodes)
exp(0.25)
G <- survival::survreg(Surv(rectime,censrec==0)~1,data=gbcsCS)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
G
G <- survival::survreg(survival::Surv(time,status==0)~1,data=Melanoma)
G
summary(G)
G$scale
G$dist
G$df.residual
sd(residuals(G))
F1 <- survival::survreg(survival::Surv(time,status==1)~logthick+age+sex+ulcer+epicel+ici1+ici2+ici3,data=Melanoma)
F1
F_rec <- survival::survreg(Surv(rectime,censrec==1)~age+menopause+hormone+size+grade+nodes+prog_recp+estrg_recp,data=gbcsCS)
F_rec <- survival::survreg(survival::Surv(rectime,censrec==1)~age+menopause+hormone+size+grade+nodes+prog_recp+estrg_recp,data=gbcsCS)
F
F_rec
summary(F_rec)
F_rec <- survival::survreg(survival::Surv(rectime,censrec==1)~age+menopause+hormone+size+grade+nodes+prog_recp,data=gbcsCS)
F_rec
summary(F_rec)
F_rec <- survival::survreg(survival::Surv(rectime,censrec==1)~menopause+hormone+size+grade+nodes+prog_recp,data=gbcsCS)
summary(F_rec)
F_rec <- survival::survreg(survival::Surv(rectime,censrec==1)~hormone+size+grade+nodes+prog_recp,data=gbcsCS)
summary(F_rec)
F_rec <- survival::survreg(survival::Surv(rectime,censrec==1)~hormone+grade+nodes+prog_recp,data=gbcsCS)
summary(F_rec)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~age+menopause+hormone+size+grade+nodes+prog_recp+estrg_recp,data=gbcsCS)
summary(G)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~age+hormone+grade+nodes+prog_recp+estrg_recp,data=gbcsCS)
summary(G)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~age+hormone+grade+prog_recp,data=gbcsCS)
summary(G)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~hormone+grade+prog_recp,data=gbcsCS)
summary(G)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~hormone+prog_recp,data=gbcsCS)
summary(G)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~hormone,data=gbcsCS)
summary(G)
G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
G
F
F <- survival::survreg(survival::Surv(rectime,censrec==1)~hormone+grade+nodes+prog_recp,data=gbcsCS)
F
F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(hormone)+factor(grade)+nodes+prog_recp,data=gbcsCS)
F
summary(F)
F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
summary(F)
l1 <- glm(logthick~age+sex+ulcer+epicel+ici1+ici2+ici3,data=Melanoma)
l1
library(corrplot)
install.packages("library(corrplot)")
M = cor(gbcsCS)
eps=0.001
mean(log(gbcsCS$prog_recp))
mean(log(gbcsCS$prog_recp+eps))
sd(log(gbcsCS$prog_recp+eps))
eps=0.0001
mean(log(gbcsCS$prog_recp+eps))
sd(log(gbcsCS$prog_recp+eps))
0.000001
mean(log(gbcsCS$prog_recp+eps))
sd(log(gbcsCS$prog_recp+eps))
mean(log(gbcsCS$estr_recp+eps))
mean(log(gbcsCS$estrg_recp+eps))
sd(log(gbcsCS$estrg_recp+eps))
lhormone<- glm(nodes ~ age,data=gbcsCS,family="binomial")
lhormone<- glm(hormone ~ age,data=gbcsCS,family="binomial")
gbcsCS$hormone
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## lnodes <- glm(nodes ~ age+size+grade+prog_recp,data=gbcsCS,family="poisson")
lhormone<- glm(factor(hormone) ~ age,data=gbcsCS,family="binomial")
lhormone
summary(lhormone)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## lnodes <- glm(nodes ~ age+size+grade+prog_recp,data=gbcsCS,family="poisson")
lhormone<- glm(factor(menopause) ~ age,data=gbcsCS,family="binomial")
lhormone
summary(lhormone)
with(gbcsCS, cor(menopause, age))
with(gbcsCS, cor(hormone, age))
with(gbcsCS, cor(hormone, menopause))
F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
F
F <- survival::survreg(survival::Surv(rectime,censrec==1)~size+factor(grade)+nodes+prog_recp,data=gbcsCS)
summary(F)
F <- survival::survreg(survival::Surv(rectime,censrec==1)~size+factor(grade)+nodes+I(log(prog_recp+eps)),data=gbcsCS)
summary(F)
F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+I(log(prog_recp+eps)),data=gbcsCS)
summary(F)
l0 <- glm(sex~ulcer+epicel+ici1+ici2+ici3,data=Melanoma,family="binomial")
summary(l0)
str(gbcsCS$menopause)
View(gbcsCS)
simGBCS <- function(n){
}
data <- simGBCS(500)
simGBCS <- function(n){
}
View(simGBCS)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## l1 <- glm(nodes ~ size+grade+prog_recp,data=gbcsCS,family="poisson")
## l2<- glm(factor(menopause) ~ age,data=gbcsCS,family="binomial")
## G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
## F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
m <- lava::lvm(~age+menopause+hormone+size+grade+nodes+log_prog_recp+log_estrg_recp)
lava::distribution(m,~age) <- lava::normal.lvm(mean=53,sd=10)
lava::distribution(m,~menopause) <- lava::binomial.lvm(p=0.58)
lava::distribution(m,~hormone) <- lava::binomial.lvm(p=0.36)
lava::distribution(m,~size) <- lava::normal.lvm(mean=29,sd=14)
lava::distribution(m,~grade2) <- lava::binomial.lvm(p=0.65)
lava::distribution(m,~grade3) <- lava::binomial.lvm(p=0.23)
lava::distribution(m,~nodes) <- lava::poisson.lvm(lambda=5)
lava::distribution(m,~log_prog_recp) <- lava::normal.lvm(mean=2.1,sd=4.6)
lava::distribution(m,~log_estrg_recp) <- lava::normal.lvm(mean=2.2,sd=4.5)
lava::distribution(m,~t0) <- lava::coxWeibull.lvm(scale=exp(-7.4/0.42),shape=1/0.42)
lava::distribution(m,~t1) <- lava::coxWeibull.lvm(scale=exp(-8.2/0.73),shape=1/0.73)
transform(m,prog_recp~log_prog_recp) <- function(x){exp(x)}
transform(m,estrg_recp~log_estrg_recp) <- function(x){exp(x)}
lava::regression(m,menopause~age <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
lava::regression(m,menopause~age <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
lava::regression(m,menopause~age) <- c(0.49)
simGBCS <- function(n){
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## l1 <- glm(nodes ~ size+grade+prog_recp,data=gbcsCS,family="poisson")
## l2<- glm(factor(menopause) ~ age,data=gbcsCS,family="binomial")
## G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
## F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
m <- lava::lvm(~age+menopause+hormone+size+grade+nodes+log_prog_recp+log_estrg_recp)
lava::distribution(m,~age) <- lava::normal.lvm(mean=53,sd=10)
lava::distribution(m,~menopause) <- lava::binomial.lvm(p=0.58)
lava::distribution(m,~hormone) <- lava::binomial.lvm(p=0.36)
lava::distribution(m,~size) <- lava::normal.lvm(mean=29,sd=14)
lava::distribution(m,~grade2) <- lava::binomial.lvm(p=0.65)
lava::distribution(m,~grade3) <- lava::binomial.lvm(p=0.23)
lava::distribution(m,~nodes) <- lava::poisson.lvm(lambda=5)
lava::distribution(m,~log_prog_recp) <- lava::normal.lvm(mean=2.1,sd=4.6)
lava::distribution(m,~log_estrg_recp) <- lava::normal.lvm(mean=2.2,sd=4.5)
lava::distribution(m,~t0) <- lava::coxWeibull.lvm(scale=exp(-7.4/0.42),shape=1/0.42)
lava::distribution(m,~t1) <- lava::coxWeibull.lvm(scale=exp(-8.2/0.73),shape=1/0.73)
transform(m,prog_recp~log_prog_recp) <- function(x){exp(x)}
transform(m,estrg_recp~log_estrg_recp) <- function(x){exp(x)}
lava::regression(m,menopause~age) <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
m <- lava::eventTime(m,time~min(t0=0,t1=1),"status")
simdat <- lava::sim(m,n)
data.table::setDT(simdat)
simdat[,grade:=factor("1",levels=1:3)]
simdat[grade2==1,ici:="2"]
simdat[grade3==1,ici:="3"]
simdat[,c("grade1","grade2","t0","t1"):=NULL]
simdat$grade <- factor(simdat$grade)
simdat$menopause <- factor(simdat$menopause,levels=c("0","1"))
simdat$hormone <- factor(simdat$hormone,levels=c("0","1"))
simdat
}
data <- simGBCS(500)
simGBCS <- function(n){
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## l1 <- glm(nodes ~ size+grade+prog_recp,data=gbcsCS,family="poisson")
## l2<- glm(factor(menopause) ~ age,data=gbcsCS,family="binomial")
## G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
## F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
m <- lava::lvm(~age+menopause+hormone+size+grade+nodes+log_prog_recp+log_estrg_recp)
lava::distribution(m,~age) <- lava::normal.lvm(mean=53,sd=10)
lava::distribution(m,~menopause) <- lava::binomial.lvm(p=0.58)
lava::distribution(m,~hormone) <- lava::binomial.lvm(p=0.36)
lava::distribution(m,~size) <- lava::normal.lvm(mean=29,sd=14)
lava::distribution(m,~grade2) <- lava::binomial.lvm(p=0.65)
lava::distribution(m,~grade3) <- lava::binomial.lvm(p=0.23)
lava::distribution(m,~nodes) <- lava::poisson.lvm(lambda=5)
lava::distribution(m,~log_prog_recp) <- lava::normal.lvm(mean=2.1,sd=4.6)
lava::distribution(m,~log_estrg_recp) <- lava::normal.lvm(mean=2.2,sd=4.5)
lava::distribution(m,~t0) <- lava::coxWeibull.lvm(scale=exp(-7.4/0.42),shape=1/0.42)
lava::distribution(m,~t1) <- lava::coxWeibull.lvm(scale=exp(-8.2/0.73),shape=1/0.73)
transform(m,prog_recp~log_prog_recp) <- function(x){exp(x)}
transform(m,estrg_recp~log_estrg_recp) <- function(x){exp(x)}
lava::regression(m,menopause~age) <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
m <- lava::eventTime(m,time~min(t0=0,t1=1),"status")
simdat <- lava::sim(m,n)
data.table::setDT(simdat)
simdat[,grade:=factor("1",levels=1:3)]
simdat[grade2==1,grade:="2"]
simdat[grade3==1,grade:="3"]
simdat[,c("grade1","grade2","t0","t1"):=NULL]
simdat$grade <- factor(simdat$grade)
simdat$menopause <- factor(simdat$menopause,levels=c("0","1"))
simdat$hormone <- factor(simdat$hormone,levels=c("0","1"))
simdat
}
data <- simGBCS(500)
lava::regression(m,menopause~age) <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
m <- lava::eventTime(m,time~min(t0=0,t1=1),"status")
simdat <- lava::sim(m,n)
n=500
simdat <- lava::sim(m,n)
data.table::setDT(simdat)
simdat[,grade:=factor("1",levels=1:3)]
simdat[,grade:=factor("1")]
simdat[,grade:="1"]
simdat[,grade:=factor(1)]
##'
##' This is based on the functionality of \code{library(lava)}.
##' @title Simulate data alike the Melanoma data
##' @param n sample size
##' @return data table of size n
##' @examples
##' set.seed(71)
##' simMelanoma(3)
##' @export
##' @author Thomas A. Gerds <tag@@biostat.ku.dk>
simMelanoma <- function(n){
ici=ici1=ici2=ici3=NULL
## data(Melanoma,package="riskRegression")
## Melanoma$ici1 <- 1*(Melanoma$ici=="1")
## Melanoma$ici2 <- 1*(Melanoma$ici=="2")
## Melanoma$ici3 <- 1*(Melanoma$ici=="3")
## pici <- prop.table(table(Melanoma$ici))
## pulcer <- prop.table(table(Melanoma$ulcer))
## pepicel <- prop.table(table(Melanoma$epicel))
## psex <- prop.table(table(Melanoma$sex))
## l0 <- glm(sex~ulcer+epicel+ici1+ici2+ici3,data=Melanoma,family="binomial")
## l1 <- glm(logthick~age+sex+ulcer+epicel+ici1+ici2+ici3,data=Melanoma)
## l2 <- glm(age~sex,data=Melanoma)
## G <- survival::survreg(survival::Surv(time,status==0)~1,data=Melanoma)
## F1 <- survival::survreg(survival::Surv(time,status==1)~logthick+age+sex+ulcer+epicel+ici1+ici2+ici3,data=Melanoma)
## F2 <- survival::survreg(survival::Surv(time,status==2)~age+sex,data=Melanoma)
m <- lava::lvm(~ulcer+epicel+sex+age+logthick)
## m <- categorical(m,~ici, K=4,p=pici[-3])
lava::distribution(m,~age) <- lava::normal.lvm(mean=55,sd=10)
lava::distribution(m,~logthick) <- lava::normal.lvm(sd=0.8)
lava::distribution(m,~ici1) <- lava::binomial.lvm(p=0.29)
lava::distribution(m,~ici2) <- lava::binomial.lvm(p=0.52)
lava::distribution(m,~ici3) <- lava::binomial.lvm(p=0.11)
lava::distribution(m,~sex) <- lava::binomial.lvm(p=0.39)
lava::distribution(m,~ulcer) <- lava::binomial.lvm(p=0.44)
lava::distribution(m,~epicel) <- lava::binomial.lvm(p=0.44)
lava::distribution(m,~t0) <- lava::coxWeibull.lvm(scale=exp(-8/0.33),shape=1/0.33)
lava::distribution(m,~t1) <- lava::coxWeibull.lvm(scale=exp(-11.5/0.8),shape=1/0.8)
lava::distribution(m,~t2) <- lava::coxWeibull.lvm(scale=exp(-16/1.3),shape=1/1.3)
transform(m,thick~logthick) <- function(x){exp(x)}
lava::regression(m,sex~ulcer+epicel+ici1+ici2+ici3) <- c(0.83,0.67,-0.28,0.03,-0.28)
lava::regression(m,logthick~age+sex+ulcer+epicel+ici1+ici2+ici3) <- c(0.007,0.23,0.9,-0.35,0.56,0.73,0.83)
lava::regression(m,t1~logthick+age+sex+ulcer+epicel+ici1+ici2+ici3) <- -c(-0.29,-0.02,-0.34,-0.77,0.53,-1.39,-1.32,-1.7)/0.8
lava::intercept(m,"logthick") <- -1.3
lava::regression(m,t2~age+sex) <- -c(-0.08,-0.39)/1.3
m <- lava::eventTime(m,time~min(t0=0,t1=1,t2=2),"status")
simdat <- lava::sim(m,n)
data.table::setDT(simdat)
simdat[,ici:=factor("0",levels=0:3)]
simdat[ici1==1,ici:="1"]
simdat[ici2==1,ici:="2"]
simdat[ici3==1,ici:="3"]
simdat[,c("ici1","ici2","ici3","t0","t1","t2"):=NULL]
simdat$ici <- factor(simdat$ici)
simdat$ulcer <- factor(simdat$ulcer,levels=c("0","1"),labels=c("not present","present"))
simdat$epicel <- factor(simdat$epicel,levels=c("0","1"),labels=c("not present","present"))
simdat$sex <- factor(simdat$sex,levels=c("0","1"),labels=c("Female","Male"))
simdat
}
dat<- simMelanoma(500)
simdat[,grade:=factor("0",levels=0:2)]
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## l1 <- glm(nodes ~ size+grade+prog_recp,data=gbcsCS,family="poisson")
## l2<- glm(factor(menopause) ~ age,data=gbcsCS,family="binomial")
## G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
## F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
m <- lava::lvm(~age+menopause+hormone+size+nodes+log_prog_recp+log_estrg_recp)
lava::distribution(m,~age) <- lava::normal.lvm(mean=53,sd=10)
lava::distribution(m,~menopause) <- lava::binomial.lvm(p=0.58)
lava::distribution(m,~hormone) <- lava::binomial.lvm(p=0.36)
lava::distribution(m,~size) <- lava::normal.lvm(mean=29,sd=14)
lava::distribution(m,~grade2) <- lava::binomial.lvm(p=0.65)
lava::distribution(m,~grade3) <- lava::binomial.lvm(p=0.23)
lava::distribution(m,~nodes) <- lava::poisson.lvm(lambda=5)
lava::distribution(m,~log_prog_recp) <- lava::normal.lvm(mean=2.1,sd=4.6)
lava::distribution(m,~log_estrg_recp) <- lava::normal.lvm(mean=2.2,sd=4.5)
lava::distribution(m,~t0) <- lava::coxWeibull.lvm(scale=exp(-7.4/0.42),shape=1/0.42)
lava::distribution(m,~t1) <- lava::coxWeibull.lvm(scale=exp(-8.2/0.73),shape=1/0.73)
transform(m,prog_recp~log_prog_recp) <- function(x){exp(x)}
transform(m,estrg_recp~log_estrg_recp) <- function(x){exp(x)}
lava::regression(m,menopause~age) <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
m <- lava::eventTime(m,time~min(t0=0,t1=1),"status")
simdat <- lava::sim(m,n)
data.table::setDT(simdat)
simdat[,grade:=factor("0",levels=0:2)]
simdat[,grade:=factor("1",levels=1:3)]
simdat[grade2==1,grade:="2"]
simdat[grade3==1,grade:="3"]
simdat[,c("grade1","grade2","t0","t1"):=NULL]
simdat$grade <- factor(simdat$grade)
simdat$menopause <- factor(simdat$menopause,levels=c("0","1"))
simdat[,c("grade3","grade2","t0","t1"):=NULL]
View(simdat)
## data("gbcsCS", package = "condSURV")
## gbcsCS$grade2 <- 1*(gbcsCS$grade=="2")
## gbcsCS$grade3 <- 1*(gbcsCS$grade=="3")
## pmenopause <- prop.table(table(gbcsCS$menopause))
## phormone <- prop.table(table(gbcsCS$hormone))
## pgrade <- prop.table(table(gbcsCS$grade))
## l1 <- glm(nodes ~ size+grade+prog_recp,data=gbcsCS,family="poisson")
## l2<- glm(factor(menopause) ~ age,data=gbcsCS,family="binomial")
## G <- survival::survreg(survival::Surv(rectime,censrec==0)~1,data=gbcsCS)
## F <- survival::survreg(survival::Surv(rectime,censrec==1)~factor(grade)+nodes+prog_recp,data=gbcsCS)
m <- lava::lvm(~age+menopause+hormone+size+nodes+log_prog_recp+log_estrg_recp)
lava::distribution(m,~age) <- lava::normal.lvm(mean=53,sd=10)
lava::distribution(m,~menopause) <- lava::binomial.lvm(p=0.58)
lava::distribution(m,~hormone) <- lava::binomial.lvm(p=0.36)
lava::distribution(m,~size) <- lava::normal.lvm(mean=29,sd=14)
lava::distribution(m,~grade2) <- lava::binomial.lvm(p=0.65)
lava::distribution(m,~grade3) <- lava::binomial.lvm(p=0.23)
lava::distribution(m,~nodes) <- lava::poisson.lvm(lambda=5)
lava::distribution(m,~log_prog_recp) <- lava::normal.lvm(mean=2.1,sd=4.6)
lava::distribution(m,~log_estrg_recp) <- lava::normal.lvm(mean=2.2,sd=4.5)
lava::distribution(m,~t0) <- lava::coxWeibull.lvm(scale=exp(-7.4/0.42),shape=1/0.42)
lava::distribution(m,~t1) <- lava::coxWeibull.lvm(scale=exp(-8.2/0.73),shape=1/0.73)
transform(m,prog_recp~log_prog_recp) <- function(x){exp(x)}
transform(m,estrg_recp~log_estrg_recp) <- function(x){exp(x)}
lava::regression(m,menopause~age) <- c(0.49)
lava::regression(m,t1~grade2+grade3+nodes+log_prog_recp) <- -c(-0.47, -0.59, -0.044, 0.042)/0.73
m <- lava::eventTime(m,time~min(t0=0,t1=1),"status")
simdat <- lava::sim(m,n)
data.table::setDT(simdat)
simdat[,grade:=factor("1",levels=1:3)]
simdat[grade2==1,grade:="2"]
simdat[grade3==1,grade:="3"]
simdat[,c("grade3","grade2","t0","t1"):=NULL]
simdat$grade <- factor(simdat$grade)
simdat$menopause <- factor(simdat$menopause,levels=c("0","1"))
simdat$hormone <- factor(simdat$hormone,levels=c("0","1"))
simdat
View(gbcsCS)
colnames(simdat$time)<-"rectime"
simdat[,10:11]
colnames(simdat[,10:11])<-c("rectime", -"censrec")
colnames(simdat[,10:11])<-c("rectime", "censrec")
simdat
colnames(simdat[,10:11])<-c("rectime", "censrec")
simdat
with(Melanoma, cor(sex, ulcer))
with(Melanoma, cor(logthick, age))
View(Melanoma)
glm(I(log(prog_recp+eps)~age+menopause+hormone+size+nodes+estrg_recp))
glm(I(log(prog_recp+eps)~age+menopause+hormone+size+nodes+estrg_recp), data=gbcsCS)
summary(glm(I(log(prog_recp+eps)~age+menopause+hormone+size+nodes+estrg_recp), data=gbcsCS))
summary(glm(I(log(prog_recp+eps)~age+factor(menopause)+factor(hormone)+factor(grade)+size+nodes+estrg_recp), data=gbcsCS))
summary(glm(I(log(prog_recp+eps)~age+factor(menopause)+factor(hormone)+factor(grade)nodes+estrg_recp), data=gbcsCS))
summary(glm(I(log(prog_recp+eps)~age+factor(menopause)+factor(hormone)+factor(grade)+nodes+estrg_recp), data=gbcsCS))
summary(glm(I(log(prog_recp+eps)~age+factor(menopause)+factor(grade)+nodes+estrg_recp), data=gbcsCS))
summary(glm(I(log(prog_recp+eps)~factor(menopause)+factor(grade)+nodes+estrg_recp), data=gbcsCS))
summary(glm(I(log(prog_recp+eps)~factor(menopause)+factor(grade)+estrg_recp), data=gbcsCS))
summary(glm(size~age+factor(menopause)+factor(hormone)+factor(grade)+nodes+estrg_recp), data=gbcsCS))
summary(glm(size~age+factor(menopause)+factor(hormone)+factor(grade)+nodes+estrg_recp, data=gbcsCS))
summary(glm(size~age+factor(hormone)+factor(grade)+nodes+estrg_recp, data=gbcsCS))
summary(glm(size~age+factor(grade)+nodes+estrg_recp, data=gbcsCS))
summary(glm(size~age+nodes+estrg_recp, data=gbcsCS))
summary(glm(size~nodes+estrg_recp, data=gbcsCS))
summary(glm(size~nodes, data=gbcsCS))
summary(glm(size~nodes+prog_recp, data=gbcsCS))
summary(glm(size~nodes, data=gbcsCS))
with(gbcsCS, cor(size, nodes))
with(gbcsCS, cor(estr_recp, prog_recp))
with(gbcsCS, cor(estrg_recp, prog_recp))
with(gbcsCS, cor(estrg_recp, nodes))
with(gbcsCS, cor(estrg_recp, size))
with(gbcsCS, cor(prog_recp, size))
with(gbcsCS, cor(prog_recp, nodes))
with(gbcsCS, cor(estr_recp, age))
with(gbcsCS, cor(estrg_recp, age))
with(gbcsCS, cor(prog_recp, age))
with(gbcsCS, cor(size, age))
with(gbcsCS, cor(nodes, age))
with(gbcsCS, cor(nodes, hormone))
with(gbcsCS, cor(size, hormone))
with(gbcsCS, cor(age, hormone))
with(gbcsCS, cor(estrg_recp, hormone))
with(gbcsCS, cor(prog_recp, hormone))
with(gbcsCS, cor(menopause, hormone))
with(gbcsCS, cor(menopause, nodes))
with(gbcsCS, cor(menopause, size))
with(gbcsCS, cor(menopause, estr_recp))
with(gbcsCS, cor(menopause, estrg_recp))
glm(I(log(estrg_recp+eps))~factor(hormone)+factor(age)+factor(menopause), data=gbcsCS)
summary(glm(I(log(estrg_recp+eps))~factor(hormone)+age+factor(menopause), data=gbcsCS)
)
summary(glm(estrg_recp~factor(hormone)+age+factor(menopause), data=gbcsCS)
)
summary(glm(estrg_recp~factor(hormone)+age+factor(menopause)+prog_recp, data=gbcsCS))
summary(glm(menopause~factor(hormone)+age+estr_recp, data=gbcsCS))
summary(glm(menopause~factor(hormone)+age+estrg_recp, data=gbcsCS))
summary(glm(prog_recp~factor(hormone)+age+factor(menopause)+estrg_recp, data=gbcsCS))
summary(glm(prog_recp~age+factor(menopause)+estrg_recp, data=gbcsCS))
summary(glm(estrg_recp~factor(hormone)+age+factor(menopause)+prog_recp, data=gbcsCS))
summary(glm(estrg_recp~factor(hormone)+age+prog_recp, data=gbcsCS))
summary(glm(estrg_recp~age+prog_recp, data=gbcsCS))
summary(glm(estrg_recp~age, data=gbcsCS))
summary(glm(I(log(estrg_recp+eps)~age, data=gbcsCS))
summary(glm(I(log(estrg_recp+eps))~age, data=gbcsCS))
summary(glm(I(log(estrg_recp+eps))~age, data=gbcsCS))
summary(glm(I(log(estrg_recp+eps))~age+prog_recp, data=gbcsCS))
summary(glm(size ~factor(grade), data=gbcsCS))
summary(glm(nodes ~factor(grade), data=gbcsCS))
summary(glm(grade2 ~nodes, data=gbcsCS))
summary(glm(grade1 ~nodes, data=gbcsCS))
summary(glm(grade3 ~nodes, data=gbcsCS))
mvn.lvm(2, rho=c(2,1, 2.2))
mvn.lvm(2, rho=c(2,1, 2.2), sigma= matric(c(4.6, 0.3, 4.5, 0.3), ncol=2)))
matric(c(4.6, 0.3, 4.5, 0.3)
matric(c(4.6, 0.3, 4.5, 0.3), ncol=2)
matrix(c(4.6, 0.3, 4.5, 0.3), ncol=2)
mvn.lvm(2, rho=c(2,1, 2.2), sigma= matrix(c(4.6, 0.3, 4.5, 0.3), ncol=2))
lava::distribution(m,~recp) <- lava::mvn.lvm(2, rho=c(2,1, 2.2), sigma= matrix(c(4.6, 0.3, 4.5, 0.3), ncol=2))
simdat <- lava::sim(m,n)
for(i in 9:500){
data <- simulateData(400)
fit <- fitLTMLE(data, t=c(1,2), L0nodes = c("L01", "L02"), Anode = "A", Cnodes = c("C1", "C2"),
Lnodes = c("L1", "L2"), Mnodes = c("M1", "M2"), RYnode = "RY", Ynode = "Y",
Cmodel, Mmodel, Mmodel, RYmodel, Ymodel, QLmodel, a1 = 1, a0 = 0, n_bins = 20,
Mlearner=sl_dens_lrnr, glearner=sl_dens_lrnr)
fit2 <- fitLTMLE(data, t=c(1,2), L0nodes = c("L01", "L02"), Anode = "A", Cnodes = c("C1", "C2"),
Lnodes = c("L1", "L2"), Mnodes = c("M1", "M2"), RYnode = "RY", Ynode = "Y",
Cmodel, Mmodel, Mmodel, RYmodel, Ymodel, QLmodel, a1 = 1, a0 = 0, n_bins = 20,
Mlearner=NULL, glearner=NULL)
res[[i]] <- fit
res2[[i]] <- fit2
print(i)
}
